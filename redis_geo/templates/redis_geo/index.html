<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <title>Hello, world!</title>
</head>
<body>
<h1>Hello, world!</h1>

<!-- Optional JavaScript; choose one of the two! -->

<!-- Option 1: Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

<!-- Option 2: Separate Popper and Bootstrap JS -->
<!--
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
-->
<button type="button" class="btn btn-outline-primary" id="set-point0">Initialize point on map</button>
<button type="button" class="btn btn-outline-primary" id="set-point1">Set point on map</button>
<button type="button" class="btn btn-outline-secondary" id="select-point">select point on map</button>

<script>
    const btn_setpoint0 = document.getElementById('set-point0')
    const btn_setpoint1 = document.getElementById('set-point1')
    const btn_selectpoint = document.getElementById('select-point')

    btn_setpoint0.addEventListener('click', ()=>{
        requestSetPoint('http://localhost:8000/redis_geo/setpoint?settype=0')
        console.log('set click - 0')
    })
    btn_setpoint1.addEventListener('click', ()=>{
        requestSetPoint('http://localhost:8000/redis_geo/setpoint?settype=1' )
        console.log('set click - 1')
    })
    btn_selectpoint.addEventListener('click', ()=>{
        requestSelectPoint('http://localhost:8000/redis_geo/selectpoint/' )
        console.log('select click')
    })
    function getCookie(name) {
        var cookieValue = null; if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].replace(' ', '');
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1)); break;
                }
            }
        } return cookieValue;
    }



    function postData(url = '', data = {}) {
        var headers = new Headers();
        var csrftoken = getCookie('csrftoken');
        headers.append('X-CSRFToken', csrftoken);
        headers.append('Accept', 'application/json');
        headers.append('Content-Type', 'application/json');

        // Default options are marked with *
        return fetch(url, {
            method: 'POST', // *GET, POST, PUT, DELETE, etc.
            headers: headers,
            body: JSON.stringify(data), // body data type must match "Content-Type" header
        }).then(response => response.json()); // parses JSON response into native JavaScript objects
    }


    function requestSelectPoint(url ){
        postData(url,{
            title: "Test",
            body: "I am testing!",
            userId: 1
        }).then((data) => console.log(data))
          .catch((error) => console.log(error));
    }

    function requestSetPoint(url ){
        fetch(url)
            .then((response) => {
                console.log(response.json())
            }).catch((error)=>{
                console.log(error)
            });
    }


</script>
</body>
</html>
